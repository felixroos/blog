{"componentChunkName":"component---node-modules-gatsby-theme-blog-core-src-templates-post-query-js","path":"/polyphonic-cv/","result":{"data":{"site":{"siteMetadata":{"title":"Loophole Letters","social":[{"name":"github","url":"https://github.com/felixroos"},{"name":"GitHub","url":"https://github.com/gatsbyjs"}]}},"blogPost":{"__typename":"MdxBlogPost","id":"d61bf6ee-8b0c-5e6c-85b8-8a001ca9d0dc","excerpt":"After looking at the basics of analog synthesis in the  last post ,\nlet's now look at how to approach polyphony. So far, I used the Arturia…","body":"function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Polyphonic MIDI to CV\",\n  \"date\": \"2021-05-22T00:00:00.000Z\",\n  \"keywords\": [\"synthesis\", \"electronics\"]\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"After looking at the basics of analog synthesis in the \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"./analog-synthesis\"\n  }, \"last post\"), \",\\nlet\\u2019s now look at how to approach polyphony.\"), mdx(\"p\", null, \"So far, I used the Arturia Keystep to send pitch and gate CV to the VCO.\\nTo be able to play multiple notes at once, we need multiple channels of pitch and gate CV.\"), mdx(\"h2\", {\n    \"id\": \"midi-to-cv\"\n  }, \"MIDI to CV\"), mdx(\"p\", null, \"Using an Arduino + a DAC (= Digital to Analog Converter), we can set the pitch CV output to an analog voltage whenever a MIDI note message is received:\"), mdx(\"p\", null, mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1115px\"\n    }\n  }, \"\\n      \", mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"77.97101449275362%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAIAAACZeshMAAAACXBIWXMAAAsTAAALEwEAmpwYAAACFklEQVQoz5WT3U/TUBjG+29548eNRhMTTbhBEiNEQ6IOTRQNIXAx48cwohd45c1udOjNYoyBCy1G4kZk7KMNbbduZRltZ7e1LF1XytqCT9elDBSJT5qn57yn73vO+Z1Twt3dXROEFXY9xTF4fnJsls8zQpEuFtY3NjqOs3e0iO0d60Hs7dDcq4EXM2dCt87dCYVmn03Ozd4IT917NF1vNjVVFSWp0WhUq9VarVYul+GiKKJLuDvWp29fJz7Gxz+8Oz08MjBy/WJ4evT508Gx29eGr5YVRdrcpCiqUCjAkUnTNM/zqqqiHKEbxoWZyMnIk7ORxyfujl2afHh54v5QeOrUzdHzVwY5UcTyHMdxXeyvJ7R7y0aMKgqJdHY1R5GptTdfyNUcnczRK9lcmmE7tn3UhlGFCFpwWW/FaNrrHvzI90BBt5fsdkNFVX2ZTO4n7B0jL9m27Xa73dzakuv1HwxTlfGuS5LU6XQwqigK2IAwgj5ntSsPGIYzmUw6nY7Nzy8uLDAUFY/Ho9FoIpEwDAOjDMOAMDyVSuW7Qt1WV72ZIdM0W6Ypapq17QmZPlU4aGMjvh9edh8w/f0fwI7Zc5AsaNrrPmDB0CH9PfmXYXzm+f+e2VuzLBc4rpTPg42u60FR4K1UKnDcTXipVLIsa/+S+NOyLEsuLX1fXiZJEkcSxAEPLOHA2w/ywMwIgTnO1vnnb9iv30AdY6XscjwKAAAAAElFTkSuQmCC')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"idea\",\n    \"title\": \"idea\",\n    \"src\": \"/blog/static/15a99b99d99b0d33ae195326e5a756d1/0d6fe/idea.png\",\n    \"srcSet\": [\"/blog/static/15a99b99d99b0d33ae195326e5a756d1/e4d6b/idea.png 345w\", \"/blog/static/15a99b99d99b0d33ae195326e5a756d1/1e043/idea.png 690w\", \"/blog/static/15a99b99d99b0d33ae195326e5a756d1/0d6fe/idea.png 1115w\"],\n    \"sizes\": \"(max-width: 1115px) 100vw, 1115px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\"\n  }), \"\\n    \")), mdx(\"p\", null, \"The Arduino receives a MIDI note message, calculates the correct voltage for that note and sends the voltage through the DAC to the VCO.\"), mdx(\"h2\", {\n    \"id\": \"digital-to-analog-conversion\"\n  }, \"Digital to Analog Conversion\"), mdx(\"p\", null, \"Without a DAC, an Arudino is not able to produce \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"true analog output\"), \"\\u2122, meaning a voltage that is not either 0V or 5V.\"), mdx(\"h3\", {\n    \"id\": \"what-about-analogwrite\"\n  }, \"What about analogWrite?\"), mdx(\"p\", null, \"If you\\u2019ve already worked with Arduino, you might know the analogWrite function, which suggests that we output an analog voltage.\\nBut in fact, analogWrite will only output a \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://www.arduino.cc/en/Tutorial/Foundations/PWM\"\n  }, \"PWM wave\"), \", which looks like this:\"), mdx(\"p\", null, mdx(\"img\", {\n    parentName: \"p\",\n    \"src\": \"https://www.arduino.cc/wiki/54ef6da144b4531dd9ada686a7e67c56/pwm.gif\",\n    \"alt\": \"pwm waves\"\n  })), mdx(\"p\", null, \"So this is still just a digital signal. It can be useful to dim LEDs for example, but it\\u2019s not sufficient for a VCO.\"), mdx(\"h3\", {\n    \"id\": \"poor-mans-dac\"\n  }, \"Poor Mans DAC\"), mdx(\"p\", null, \"What i heard somewhere referred to as the \\u201CPoor Mans DAC\\u201D, is by filtering the PWM output of the arduino.\\nThis will filter out the higher frequencies of the pulse wave, leaving a more or less mean value.\\nYou can read more about it \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://create.arduino.cc/projecthub/Arduino_Scuola/build-a-simple-dac-for-your-arduino-4c00bd\"\n  }, \"here\"), \".\"), mdx(\"p\", null, \"I tested this too (using a TL074 instead of a TL2451):\"), mdx(\"p\", null, mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1380px\"\n    }\n  }, \"\\n      \", mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"64.92753623188406%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAABYlAAAWJQFJUiTwAAADjElEQVQ4yx2R60/bVRyH+x9olvjCYTRZMCZMMYuZY8l0iC6abFAyBuHaFVihwBQHDGwAR9nGdVD4jcsoFGhLS6GwcukNWnq/cesGibjNN77w/3g8+uKTfL/nxXPOeT6y18Ymjg31pOdU/2d/Sklq8i5JqYrUxF0S41ViVnAozv+btyceEJLu8WpWjWeoksnfSrE+KuNY7OlZFbLETD2JGTVvohaSe1YCXjPxoJ3o3iqhnRUO4i4OYm4iYSeJxC4aTTNO9zqpgzDjun6cXid7fjezPXWcmpqR+cdqCE428s/b15wcpTiKBHmTPuA0ESHucxP172K22Qh5tkkFd3CtLBHZfknSu8Hu2jIRp4O//zzh5dwYfarvkXmGlfgkNX+dxDlKBTlKBDgUiQU8+MRLFhdmWLKZ2d3ZwuNyMDykpUPXh870gl2Pg4B/m+RxnLf7Tp6qbiBz9VfgGm3A7d1lzmxAb9KjN+qRZiSGpSGk6RHGp57xeOgx2gEtulENM3otzTM6frXMsy4uPvvjFafxbQITagGUuhhpq6JYeQfVL0qKK+Vcu/4V3+Ze5lb+dR62VKFQ3MRgHEI/P0B5RRGK8ls01inIK5GT01xP75YdX3CDgO4esnB0h2Rwka6uBrqGenj05AFXr35B9pefkZOTzW15LvL8XFpaa2hsrCAr61POZ3zAhQsZZH7yIbXV5UgbNpr0I9zvES0vWZYYHOxE2VDCC9MIrZo6Acri8tcXuSLAxUXfoawu4GJ2Jh9lnOP2HTnd2k6hY5jx6XGsophYPMyB8D/YK4BTbQraasuQV92ntLaFospqCosLKVMUU1QqJ//mD5SWyalSFlOrqkAnQA5Rjt1owLG5htvvwSOS2o9g/F2BzNxZwvpoB/aNBGPTJuFpHpN1HrPVgGXNyOLzZ+g0rRhXFrA7rKxv2lgX7Zv6tMxN6rAJf2sigaiPye5qZMudhfj0HZycpdkKuXEEvXiSQZEQWxE/rlgQ+4TErHEB07aDNZ8Lq3OThf4BrMsWLG4ny2JPpI+Z7mlCZu8uIGbq4d27M+KpGOFomHT6kEQsRCy0RzoZJbpiY+NpP36LjYDJjKW9HaNGw+q0xNLoIIZ+Lat6ial28WXXYCleqZGwVQgeeMhcpxqDphZ9ayXPm4oYrv2JJ8o8egsu0ffjJTTfZNJw7TzqvI+pyTmH8sp7KHPe5+cbGfSWfs6/rPu22V1NSNAAAAAASUVORK5CYII=')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"poor mands dac\",\n    \"title\": \"poor mands dac\",\n    \"src\": \"/blog/static/ce07c9bf5252d99a6b912be58fc3e470/b1001/poormansdac.png\",\n    \"srcSet\": [\"/blog/static/ce07c9bf5252d99a6b912be58fc3e470/e4d6b/poormansdac.png 345w\", \"/blog/static/ce07c9bf5252d99a6b912be58fc3e470/1e043/poormansdac.png 690w\", \"/blog/static/ce07c9bf5252d99a6b912be58fc3e470/b1001/poormansdac.png 1380w\", \"/blog/static/ce07c9bf5252d99a6b912be58fc3e470/6568d/poormansdac.png 1660w\"],\n    \"sizes\": \"(max-width: 1380px) 100vw, 1380px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\"\n  }), \"\\n    \")), mdx(\"p\", null, \"The problem: In my test, I could only get a voltage range from 1.7V to 4.4V, which only gives us 3 octaves (at 1V/octave) + the resulting voltage was very shaky.\"), mdx(\"p\", null, \"The next thing I tried was a resistor ladder.\"), mdx(\"h3\", {\n    \"id\": \"resistor-ladder\"\n  }, \"Resistor Ladder\"), mdx(\"p\", null, \"We can use a bunch of resistors and arrange them to a so called resistor ladder to build a proper DAC:\"), mdx(\"p\", null, mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"734px\"\n    }\n  }, \"\\n      \", mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"117.39130434782608%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAXCAYAAAALHW+jAAAACXBIWXMAABYlAAAWJQFJUiTwAAAE00lEQVQ4y32Ve0yVZRzH6Y8uU7eytWptbm2ttdXWxb/qn/7KtbWazi4u3Uxzmq1mJN4CKjM0LFNbKBwOHkDQEOEAwrnAuQOHcz/vC4cDB7DQWYrGpYuCwIFPz/MeDoqt3u2z5/m9797vftfnyZiZmWF2FiYnJ4nH4yhdKkq3SjSmaMi9RqdCV2cnXV1dGqqqzu8liqIwMjJCxrzg1BTdXTGcITfmzhasqh2LahOrDbPaQlvESzgYxh/wEwgE5gkGg/j9fiKRCKNjY/8WdATdNEZbMEVsNAlMUZuwm3H4nHS0d8yL3CkYDocZHZ0TnBGCs8kpHP44exv9FEfaOB5op8DfxrGAl6KAg8LKIo4ePoquWKd54/P5NCEpKvdScGzsNkGSN7H6eimusxB0luK2V9JqPymowN1SRiTkIRgIotcXa7mMClElGl3A8LDIYTKZRIpy8zpN3jiH9udhznoV4+43qd+zmrrdq6nNep3Waj2+QBi9rohuIagKQVWISDoFUeHhtatXyWDukU629g9SVn2M5uIdmAy5mA05Gib9LtptRtrafZSUlGgVDYZChAQyVLlGhahWlD+v9XEj7uZ6l4duWylnQ2YMIR9loXbK5ygJtmOLBPA4nOiFoBSQeZMERB61HIp3WlGu/3WFicv9jF8aQPVbqQ1bqQ67OBt2znM6ZMMZ9uJxujUPpVeyIOmiLKjy7FzISUE0EcMSbMQeMWMLS0wpolb8ih+Py8OJEye0kKVQOmTZOgvaZnYmyZSoS8zVQNuhTXi+30Lr4a20HvkQd/56/KcP88uFSyJPESoqKhgcHKS/v5+BgQGN8+fPk+jtvW1SBNPCw5DViHHXWoyfrac+ewP1ORup2f4ONt03JAZ+FqH5KC8vp6+vj1gsJka1h56eFNIeHR1NT8osU5PTqN0KjkgLbsWBK+rALXAqdjF2Hq2KLpcLg8GQqrIM87aQtdG7NSmzTEvBHoV6xYKpU4ydmN9GpYUG1Yot5CAkfrLbbJTqU1X2ejvo8HpFs99RlKRsavH8/vc4aw1Gtp6qYUtljbZuqzLyUVUdH1c3kfVTEx+UVvHGwYPsqGpi9xkT2efsbDLUUGd3i+aOMCJDnk6mBC8Oj/HI5zoe33+Sl48beTK/kozMH7kr8wiLNmaTsbOQjE+PsqLgJG+VGVmlq0V34Dt26KuodncQV+XxNZdD+QxducLFgX7erzCx5rSNDVVWlu3Ts2zFKl569hkeWreNJTk6HvtSx6NfFfNe2TlasnMoPtOAORAlLjwcGhq6FfKvv10WR1SQ5/PLWFfl4MNaJ0uFxw+/9i4vLF/OovU7WZpbxD1ZP5DxSQFPZ+7j7c2beXFLJqdsrfR0qgzLtkmHfGH4DxbvKmBxdiEPiB8X7TnO3XsKWSLsBzPzuS+3hCeEZ/cL+94vdDy3fS+vrFzJU2s2Um51ElOiqRymPRy9MUFOTTMHjGaBhf2CA7Vm8gRf1zWzt8ZC7lkreTVm9tU3ktdg4dsmFztFgSzuNtS0YLoPp6en6e+J4+/wEpJjJVohKAhp+DTC2ju5ipNaHAiSqHZi+7RWWnAF3BSXVG8iQUJMgZyEREKS0PYS7Vti7tucnd7LVV5wqSoLNemhFB4fnxCM/wcT/2On9lMiyn8AgAfaBv45ADYAAAAASUVORK5CYII=')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"resistor ladder\",\n    \"title\": \"resistor ladder\",\n    \"src\": \"/blog/static/554bf6ba49ae481f19a89877b0bf5c58/c6d67/resistor-ladder-sketch.png\",\n    \"srcSet\": [\"/blog/static/554bf6ba49ae481f19a89877b0bf5c58/e4d6b/resistor-ladder-sketch.png 345w\", \"/blog/static/554bf6ba49ae481f19a89877b0bf5c58/1e043/resistor-ladder-sketch.png 690w\", \"/blog/static/554bf6ba49ae481f19a89877b0bf5c58/c6d67/resistor-ladder-sketch.png 734w\"],\n    \"sizes\": \"(max-width: 734px) 100vw, 734px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\"\n  }), \"\\n    \")), mdx(\"p\", null, \"Essentially, we are using a multi layered \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://en.wikipedia.org/wiki/Voltage_divider\"\n  }, \"Voltage Divider\"), \".\\nThe lower row of resistors are 2K and the upper row are 1K.\\nTo read more on how and why it works, I recommend \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://create.arduino.cc/projecthub/instrumentation-system/dac-8-bit-using-r-2r-ladder-964837\"\n  }, \"this article\"), \".\"), mdx(\"p\", null, \"Using this code:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-c\"\n  }, \"void setup() {\\n  pinMode(5, OUTPUT);\\n  pinMode(6, OUTPUT);\\n  pinMode(7, OUTPUT);\\n  pinMode(8, OUTPUT);\\n  pinMode(9, OUTPUT);\\n  pinMode(10, OUTPUT);\\n  pinMode(11, OUTPUT);\\n  pinMode(12, OUTPUT);\\n}\\n\\nvoid loop() {\\n  int value = 127; // value between 0 and 255\\n  int bits = 8;\\n  for (int i = 0; i < bits; ++i) {\\n    int digit = bitRead(value, i);\\n    digitalWrite(5 + i, digit);\\n  }\\n}\\n\")), mdx(\"p\", null, \"The value can be set between 0 and 255 (= 256 values = 2^8 = 8 bit DAC).\\nIf we measure the voltage, we get approximately 2.5V for 127:\"), mdx(\"p\", null, mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1380px\"\n    }\n  }, \"\\n      \", mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"60.57971014492753%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABYlAAAWJQFJUiTwAAADX0lEQVQozx2S/VPTBRyA91vdVXehRBF0vFlBasfBHVzEe6ImlKLAJEALI7ZBV8PmBLa5oQ4mb6NR3IUbMEBlwOAY0Bxs4ATZGDBE402t/L3/4el7/vD8+tzzeRHt90nZNkvY+L2S5Y4LzOtLcagKcWmL8Vwvxdl4lkBbOX/3yfjPdpmXnj8YH+jEbNLRa2rC3N3EoIC9V8/WzG1E+9Yanlkk7P9WyV9dFTw1lrNlKCHYUozv+lm8mkKWm8QEDaXs9tXhnbejVEjRNykw6OtpUMpQ1deiqKum7ZYG0T8WGf/2/MB+r4xd8088H6rnxaiOZ/YWXsz2sHdXx2pbGYFmMf6uH/E4x+joVDF410j/cCdWgf7BDkwmLe3NDYheOm6zHZhn77GXJxsCwSV2nq6xFfSxtb2Dx9rN1NUCZtVf4++sxj07QqtRxcC9LnoHbtE31M6wzUS7sVGo/gXRrtPO2voqwU0/Pv9DfCsLPN4M8GRzFe+jh8yajcIuxUyrT+M2fM/c7D3qpBXIay9yRVmDVPINMmkZNbIK1A21iHZckwQeLbIhFPn83ldCn8/LfeckY5PjLEwM86DtAm59MePXLjI9fYf2LzK4nJdOc4eOc2eOkZL0MRJJGW2tKkTbSy78nj9Zf1W4xNLyIiOjFqqrzlHfqOD+pA2nvpzBK19hVZ5nwm7lRE4KXwrk56WRk5FM/slMTp1IQ1otFoQbK6wJNb51H3OeeSYcDozGm5wvykWtUTA3M8WYppSrxan8Kj2FbbSfguPpfJZylEMx7xMVcZDD8VFkpSdR9V2RMPL2JuvTNmbcLoZsNsyWfnRNDWRmJguFcjyuGbrlJWQnRqMtz2LcPsjxY58TER5CgiBKSvyQhI8iSfz0kCAsEQqf77LqGGVs9A49/X0Y2rvQ3dQhV1ajbjbgci8gExcQ+c5byM6kMDU1Qlp6MpERB3g39A3CQt/kyOEY4gVphThfuPJekJXFOXo69GiuqdCqVajq5PR0G6iTC7+lkJGfk0FWdBhacTqTjnFSU4/wQeQBPkmIIS42grjocCLee5tLFYWIliw/Y9NXYqrNQ191kpZvMzCUZfNgxkHvDR03inNJSzqKLD6S1qJsHE4HucJBDoa8RmxMuCCNIzYqjNCQ15FeKuF/iaRfRi1MVr0AAAAASUVORK5CYII=')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"resistor ladder\",\n    \"title\": \"resistor ladder\",\n    \"src\": \"/blog/static/a66ae046a07fe12863933e140cfbf4fe/b1001/resistor-ladder.png\",\n    \"srcSet\": [\"/blog/static/a66ae046a07fe12863933e140cfbf4fe/e4d6b/resistor-ladder.png 345w\", \"/blog/static/a66ae046a07fe12863933e140cfbf4fe/1e043/resistor-ladder.png 690w\", \"/blog/static/a66ae046a07fe12863933e140cfbf4fe/b1001/resistor-ladder.png 1380w\", \"/blog/static/a66ae046a07fe12863933e140cfbf4fe/599ea/resistor-ladder.png 1926w\"],\n    \"sizes\": \"(max-width: 1380px) 100vw, 1380px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\"\n  }), \"\\n    \")), mdx(\"p\", null, \"Let\\u2019s step up the game once more and look at an even better solution, as we would quickly run out of\\noutput pins if we built our multi channel dac with resistor ladders.\"), mdx(\"h3\", {\n    \"id\": \"using-the-mcp4728\"\n  }, \"Using the MCP4728\"), mdx(\"p\", null, \"Using an IC DAC, like the MCP4728, we can have 4 channel \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"true analog output\"), \"\\u2122 without using zillions of pins.\\nThe integration is really easy with a breakout board, like the one from Adafruit:\"), mdx(\"p\", null, mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"862px\"\n    }\n  }, \"\\n      \", mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"75.94202898550725%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAABYlAAAWJQFJUiTwAAADn0lEQVQ4y5WUW0wcVRzG981HeWg0qbFNMUYlorYNbSFEW5NK0xhNjYUHjbHqG0ZNbB+81IbYpnIpEEuJYBAKdAEBKRSRhd1lL+zuzM7u7GV2d7q7ULJVbrG2BWqCBfx5dmhIfDFxki//b+Y7c/7Xc0zrGxtsYf0B/pOvswHc+yPDrYyf25kgy4tp41tWM21sZOn/eP7eXL86o3LXcZmVwDCr04EtzZT1nLm5yPT0LInEDAl9hvTUbySTGeKJGyRTN0mnfxXaDa5fz5BOZdCnFtAdFqYGmkn2f4futpFMz5ISmmltbY1UPEFMDSG7Jw1ElCCqJCM53YaNKAEkl5uA10fE70eRgwQHzcTNF9CaPsc/OkhQVgjL/uyG60zrOnokTCKLcJikFiUmrBZVSQme1fRwyODxkEo0ohFzXkM3V5Fq/JiI7CIeEf8IzbQmCqlqMSaEd6uIwun14pFV7PI4Zv8QVm8A66SHYYdLcBlZROiR/HgD42jWZoIDFXhUJ2ooik+SMP35132K6rs4eLGbY819FNZ18kJNL8da6nm54QKl31/jRMdVPm3ro7y1D6uk0GNuo+zEcUrePsIr75TwatlRWpobkCQfpuXlZdonfJQ0DVB2xULO6SZyDpWy/60Snj5fSd65DvYJZ/3V9fT0DjFoneDNNw7zRN4O8p5/kn3Fu9m+4xEKCp5j2HIV04rYsNvhJb+qgw/67Dx6poltxa9TdPwlCmurMZU38tAnNbz27vuUnvqCEdGoZ3J3UnxgD4UFezj04kH2F+xlW87DDHV3Ybq3ep+9NZ3knm0h/5s2njrfyq6vO0S61RxuqCO38kcOXOzk6GdnOFJRgz0W4WzVl+wuepad+Y/xeP52doloPyx/D4fTvtkUnxrGJgpvc7qwuQQ8qih8L5fGexjsHWaktVWgx4CztZuf6xqpqqygqquWr9rPUftDPWOjo7jd7uxgr5NO6kREy4MBPyFVEWORIBEd4oq7iZC3jV86TtL/bTmDYkT6L33EQINAz2mUqXraJAehVIiYpqEEHsyhrk8TjSbRtJRho1oaPR6j3WLDLNLo8zk3ITm3+E8eO5dHxzBbYiRjKcJhnZiwxoZJPSUi1HA5Jg2oAXFqvAoTdh92ZwjXZJQRi5hTewCnO8qYVcFiE7o7jORTmHR58HlkcYICmymv3PqdpcUFbs/PGcjyOwvz3JmfFTfJHCuL8ywt/JsvLcwZ73eNdXPG+iz/B2MAt2onLogBAAAAAElFTkSuQmCC')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"mcp4728\",\n    \"title\": \"mcp4728\",\n    \"src\": \"/blog/static/4b05aa9a22d54da7132ec9c25d7efd68/f0551/mcp4728-sketch.png\",\n    \"srcSet\": [\"/blog/static/4b05aa9a22d54da7132ec9c25d7efd68/e4d6b/mcp4728-sketch.png 345w\", \"/blog/static/4b05aa9a22d54da7132ec9c25d7efd68/1e043/mcp4728-sketch.png 690w\", \"/blog/static/4b05aa9a22d54da7132ec9c25d7efd68/f0551/mcp4728-sketch.png 862w\"],\n    \"sizes\": \"(max-width: 862px) 100vw, 862px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\"\n  }), \"\\n    \")), mdx(\"p\", null, \"Code:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-c\"\n  }, \"// Basic demo for configuring the MCP4728 4-Channel 12-bit I2C DAC\\n#include <Adafruit_MCP4728.h>\\n#include <Wire.h>\\n\\nAdafruit_MCP4728 mcp;\\n\\nvoid setup(void) {\\n  Serial.begin(115200);\\n  while (!Serial)\\n    delay(10); // will pause Zero, Leonardo, etc until serial console opens\\n\\n  Serial.println(\\\"Adafruit MCP4728 test!\\\");\\n\\n  // Try to initialize!\\n  if (!mcp.begin()) {\\n    Serial.println(\\\"Failed to find MCP4728 chip\\\");\\n    while (1) {\\n      delay(10);\\n    }\\n  }\\n\\n  mcp.setChannelValue(MCP4728_CHANNEL_A, 4095);\\n  mcp.setChannelValue(MCP4728_CHANNEL_B, 2048);\\n  mcp.setChannelValue(MCP4728_CHANNEL_C, 1024);\\n  mcp.setChannelValue(MCP4728_CHANNEL_D, 0);\\n}\\n\\nvoid loop() { delay(1000); }\\n\")), mdx(\"p\", null, \"Reading Channel B:\"), mdx(\"p\", null, mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1380px\"\n    }\n  }, \"\\n      \", mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"86.08695652173914%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAABYlAAAWJQFJUiTwAAAEhElEQVQ4yx2S2VMTZhTF897p9KFPbafj2NJFVhVEEMvSUhTcCons2QghG9kgCSFACCEkQAJGIiHKprJGQFGkLMpm61i1te1LX9v/5NevfThz537z3XPPnHskR2Mm9qNWNocs/DhsZiuk4vlsiJ2na6yv3ueRwEpyhrm5CW7PxghOBPFPhwgnhxhbDVPjb8A20sbq9hqPH95FstQhY2vQwMtEH+/ujfCzWPBsOsb21k8kF2dILs2yuDhFNBbC5NZgDWnRxvXInjgpf93OubiM6n4l0bthNjcWBKFDykOPnM2Ag4NbN3k57iPa1UOz1Y26pZ5qeSWVDZeRNpYiNwh0VaJda+LM381k4uH95RJOtRZSrCnk3nwCyWq/kWe3I/yyu8OrvQP2NzaYGHRSr6xCbVRw9nwqH6V8SPq5z/lWmsN36gKuRa7zQbKcY3tFfNzzDaf0xeTW5HFnNo5kf22do8dbvHn5J4e7RzxYWKXH60etrcMnVJeUnSEl81NO5H9G0ZUsTkuzkOS/R0ZLAUVtBZxU55JeXUyLU82j9RUkEdUFpi31rPh9zHSPMNxiR1PbTmF9P5W1zVy8cpHyayVc/KGICmkxBVdzqNRdwTnkwDVgx9SpxjHgZWZxnsPDA0GoLGNBsD/0eZjtDBHRKBk0tjE29ZqhSJTo2Cix+A1ujkcYdpmFDY3oXTr6JyJMRoeZnEywuLXF2tYub9/+hmSytYqdkJ2ngU4Wu7xMGOpIWBXsbe6ytDQnLjzH8sJ9psRgwtvFLU8HsZFBQi4rAbORR4tJDja2OVjf5o/nL5AsO2p5NdbJwaiXdZ+bRaeC5Z4WdufnWYmPM3cjzGwkSCLYy81eJ1FLM5N2EyPGerqNNTg11fibrjLpaGCtV4Nk29fEs4CBnaCNDXHtO6MBgt12XLYWjDoFWk0DSlUtjXIZjYrryNW1KJrq0BiUmK1aBod6Geo20q8sJm6+hOQwpGfXp2H/dh/h4V7SUo/zZconpJ44RnracU5mpZCbm0pOzgmys78mJ1vUM/8hnbTMLygrL2JhdpwZp4x7jioRm6COoyE9+/MRjAYVeWLQ47bQ7bHj87Yz4O+gT1S9iFF9TQXapmqM+sb/e7VSSmlpPvHYMHG7jElLBZIXkVbejNvZS8ZQq2ooLTmD2aLCYGrEbFNhb9dgE7C2qbEJWG1K8abG2dGMwVBLUeFpYtFBIuK4o5piJL8nXPw60cZOMo5MVsGF7/PpC9rpCZhxdesIhB14A1YGb7gFPAxERB31iD/ttDs1nMtLZzTcT8gkxV+dg+SfBwO8m3LxZCnOhbLzXBMhDkZc9A7YaLUp8PhMmCxyegVpW4cWo4hUl9+KzaHFYmuiIC+DQF8n/aZaHJczkPw14+ZVwkFy7hYF+ZlCZZlQ4cTmbMLtNTIQdtLu0uD06MSSNuwuLW1uHUazEqdbT/7ZdOG5naBd2HMpDcljp5SnIR13p0fJyjhOdU053X2twj+FgFIoUaM3NggCuejVwls5zbo6FCopckUV2Se/wmLWEhD+6oqP8S9U2Cm49APZWwAAAABJRU5ErkJggg==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"mcp4728 test\",\n    \"title\": \"mcp4728 test\",\n    \"src\": \"/blog/static/e1cdc3cb07c96358800f9c53df8032aa/b1001/mcp4728-test.png\",\n    \"srcSet\": [\"/blog/static/e1cdc3cb07c96358800f9c53df8032aa/e4d6b/mcp4728-test.png 345w\", \"/blog/static/e1cdc3cb07c96358800f9c53df8032aa/1e043/mcp4728-test.png 690w\", \"/blog/static/e1cdc3cb07c96358800f9c53df8032aa/b1001/mcp4728-test.png 1380w\", \"/blog/static/e1cdc3cb07c96358800f9c53df8032aa/bcec6/mcp4728-test.png 1834w\"],\n    \"sizes\": \"(max-width: 1380px) 100vw, 1380px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\"\n  }), \"\\n    \")), mdx(\"p\", null, \"For a full tutorial see \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://learn.adafruit.com/adafruit-mcp4728-i2c-quad-dac\"\n  }, \"this page\"), \".\"), mdx(\"h2\", {\n    \"id\": \"handling-midi-messages\"\n  }, \"Handling MIDI Messages\"), mdx(\"p\", null, \"Now that we have 4 12 bit output channels, we can think about how to translate a midi message to voltage.\\nTo simplify MIDI handling, we can use the \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://www.arduino.cc/en/Reference/MIDIUSB\"\n  }, \"MIDIUSB library\"), \".\"), mdx(\"p\", null, \"Taken from \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://github.com/arduino-libraries/MIDIUSB/blob/master/examples/MIDIUSB_buzzer/MIDIUSB_buzzer.ino\"\n  }, \"this example\"), \",\\nwe can read incoming midi messages like so:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-c\"\n  }, \"#include \\\"MIDIUSB.h\\\"\\n#include <Adafruit_MCP4728.h>\\n#include <Wire.h>\\n\\nvoid loop() {\\n  midiEventPacket_t rx;\\n  rx = MidiUSB.read();\\n\\n  switch (rx.header) {\\n    case 0:\\n      break; //No pending events\\n\\n    case 0x9:\\n      noteOn(\\n        rx.byte1 & 0xF,  //channel\\n        rx.byte2,        //pitch\\n        rx.byte3         //velocity\\n      );\\n      break;\\n\\n    case 0x8:\\n      noteOff(\\n        rx.byte1 & 0xF,  //channel\\n        rx.byte2,        //pitch\\n        rx.byte3         //velocity\\n      );\\n      break;\\n\\n    case 0xB:\\n      controlChange(\\n        rx.byte1 & 0xF,  //channel\\n        rx.byte2,        //control\\n        rx.byte3         //value\\n      );\\n      break;\\n  }\\n}\\n\")), mdx(\"h3\", {\n    \"id\": \"midi-note-to-voltage\"\n  }, \"MIDI note to Voltage\"), mdx(\"p\", null, \"In the noteOn method, we receive the pitch as MIDI note number:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-c\"\n  }, \"int midiOffset = 24;\\n\\nint getStep(byte pitch) {\\n  int steps = 4095;\\n  int octaves = 5;\\n  return max(0, min(round(steps / (octaves * 12) * (pitch - midiOffset)), steps));\\n}\\n\\nvoid noteOn(byte midiChannel, byte pitch, byte velocity) {\\n  mcp.setChannelValue(MCP4728_CHANNEL_A, getStep(pitch));\\n}\\n\\n// rest of code in last snippet\\n\")), mdx(\"p\", null, \"Now we can use the output channel A to control a VCO via MIDI!\"), mdx(\"h2\", {\n    \"id\": \"make-it-polyphonic\"\n  }, \"Make it polyphonic!\"), mdx(\"p\", null, \"Using the vco micromodules \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"../analog-synthesis\"\n  }, \"introduced in the last post\"), \",\\nwe can create a 3 oscillator setup like this:\"), mdx(\"p\", null, mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1380px\"\n    }\n  }, \"\\n      \", mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"73.62318840579711%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAABYlAAAWJQFJUiTwAAADtUlEQVQ4y02Sy0+jVRiH+S904crFuHHjP+DOtS6McWGiY3Rroi4MyWTUwAySoDMqYcBhxjCWQi/g0EKv9PL1Tmm/Xrm2Bfp9vXCpFCb0SuHxDJ1ET/LmnPOc9/zOezkDiHF1dU2726V9eUm71aKRL9JttsT+P9YsqHQuGq+YsHZb+Cn0Wh3+Pwbqp+fs7e3DRRu6PWiIudVlv1iid94Q7Kp/1u4JptKtX8ClYA0h1OySVxUi6V3SyQMqR3UGSqpKLBKimohxmExRTiQ4KeZxzptR5ThVWaaSSFJTCngNZvLRdY5TSUpygjPBnE9nmdXbKYl77boQVBQFXzhM+OBPRh7d4/7cz+iCWmaNZmKKnnuTd7mv/QVdaJZ54zIRVcfo1I/cfTbCYnQB47SGJWuQw9pxP2VVKRIJxzgoahj64Q6jE2NYYjYkb4iiYmRkaJDh8Z+wrtvxeoOCLTA6PMj3D4dwyh6k58tYLV4q5VJfsCgEw+E4O1uzWB2PMLqMmCQT0mqQ3V2dYOMYvYK5TfjcQba3dDhcU2idGiw+O9KiCYs9QPWk1hcsq2VCa+vIGQtejxlv2MRCQAj6/chZBy6nWK8vs+A34wv4hJ9ZnPlwBrQshaw3ERpEbVNBidqRysBZXXS5WBYd9HGw5yGZX0Het1EuBlFFvUp7EpmCjfS+KLxghQMXqlIhk0/iUgMsWTS4RYSnaoHGeU18m6Nj9tNZchs77GdzyOkItoSVaNpPqvCAeNaDJWHHFDOxkXrpt0tuc4dcepvdZAatYYKVJYmzFxf9lH3ZbcaX3WiXZ3ji0KN1S+gDThbdOqbtt3lm/Q1TdIXHwWnknHxzqccVV90OzfopGqOou9FK9ajaF/wrEOe1UQMffPY+73z7FW8MTvLg6Ryff3mbW7de5+233kRjmMGatpOKRyB3yGVedDRf5fpFA52I0Giwcnh81BdcWEvy8VMzY2Pf8fXECB8N/8rD38cZu/MN7334Lp9+8QmLdj1zcR3a0BNsfg0u/zxzazPMu8TjU0Ms/r1K9bDSF6yoJVLJLIWVx0geLSurekzPZ8Tvn0Tj0RMStY2l07iSUaSoC49njpDbgCam5w+PBp3NxqrHT6XyKuXa8Qkb+T22l6aQLcI54CUacBOSHETcDjIBB1thF5thLzs+KzvSMsXAKpHNEGvZCLmtLTY2M9T/qfcFr3u9m0WrkKC5bqaTdNBO2OiIznaSdpqy7cYagjVezlmJXjnHWeeUfCNHqaWgClOaCsWWyr/yv+2lJVGnqAAAAABJRU5ErkJggg==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"3vco simple\",\n    \"title\": \"3vco simple\",\n    \"src\": \"/blog/static/cddd84027bad415a52f47b39f7860966/b1001/3vco-simple.png\",\n    \"srcSet\": [\"/blog/static/cddd84027bad415a52f47b39f7860966/e4d6b/3vco-simple.png 345w\", \"/blog/static/cddd84027bad415a52f47b39f7860966/1e043/3vco-simple.png 690w\", \"/blog/static/cddd84027bad415a52f47b39f7860966/b1001/3vco-simple.png 1380w\", \"/blog/static/cddd84027bad415a52f47b39f7860966/913b9/3vco-simple.png 1822w\"],\n    \"sizes\": \"(max-width: 1380px) 100vw, 1380px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\"\n  }), \"\\n    \")), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Channels A, B and C of the DAC go the the VCOs 1V/oct inputs\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Pots allow tuning the oscillators\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"The saw outputs of the oscillators are mixed together using the \", mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://syntaxis.com.pl/en/micromodules/107-umix-481-exp-a.html\"\n  }, \"mix module\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Digital Pins 4, 5, 6 of the Arduino are connected to the gate of the mix mixodule\")), mdx(\"h3\", {\n    \"id\": \"voice-allocation\"\n  }, \"Voice Allocation\"), mdx(\"p\", null, \"As we have only 3 oscillators, we need some logic that allocates each of them to incoming notes.\\nTo do that, we need the following variables:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-c\"\n  }, \"int channels = 3;\\nint pressed[] = { -1, -1, -1}; // which notes are allocated on which channel, -1 = none\\nint gates[] = { 6, 5, 4}; // which pins correspond to which channel gate\\n\")), mdx(\"p\", null, \"In the noteOn method, we can iterate over the pressed array and allocate the first unused channel to the incoming note:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-c\"\n  }, \"void noteOn(byte midiChannel, byte pitch, byte velocity) {\\n  int channel = -1;\\n  for (int i = 0; i < channels; i++) {\\n    if (pressed[i] == -1 && channel == -1) {\\n      channel = i;\\n      pressed[i] = pitch;\\n      digitalWrite(gates[channel], HIGH);\\n      mcp.setChannelValue(channel, getStep(pitch));\\n    }\\n  }\\n}\\n\")), mdx(\"p\", null, \"When the note is released, we have to revert what we did:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-c\"\n  }, \"void noteOff(byte midiChannel, byte pitch, byte velocity) {\\n  int channel = -1;\\n  for (int i = 0; i < channels; i++) {\\n    if (pressed[i] == pitch && channel == -1) {\\n      channel = i;\\n      digitalWrite(gates[channel], LOW);\\n      pressed[channel] = -1;\\n    }\\n  }\\n}\\n\")), mdx(\"p\", null, \"And that\\u2019s all we need for polyphonic CV messages!\\nThis is the starting point to build any paraphonic / polyphonic synth.\\nIn the next post, I will expand the above synth to a paraphonic poor mans prophet.\"), mdx(\"h2\", {\n    \"id\": \"bonus-is-12-bit-enough-for-pitch-cv\"\n  }, \"Bonus: Is 12 bit enough for pitch CV?\"), mdx(\"p\", null, \"Some might think now: Is 12 bit anough for \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"true analog output\"), \"\\u2122 pitch CV? Let\\u2019s calculate a little bit..\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"With 12 bit, we have 2^12 = 4096 different steps representing voltages from 0 to 5V.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"At 1V/oct, we have 5\", \"*\", \"12 = 60 semitones in the volt range.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Each semitone can be broken down to 100 cents, so we have 6000 cents in our range, giving us 6000/4096 = 1.4 cents per step.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"According to \", mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"http://hyperphysics.phy-astr.gsu.edu/hbase/Music/cents.html#c4\"\n  }, \"this page\"), \", the so called \\u201CJust Noticeable Difference\\u201D (JND) in pitch\\nperception is around 5 cents.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Having 1.4 cents per step, we are way below the JND.\")), mdx(\"p\", null, \"So 12 bit should be fine.. (Maybe smaller changes in pitch are perceptible in the context of chords, but that might be topic of another discussion).\"), mdx(\"h2\", {\n    \"id\": \"future-ideas\"\n  }, \"Future Ideas\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"note stealing\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"unison mode\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"auto tuning (like bastl 1983) using \", mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://github.com/PaulStoffregen/FreqCount\"\n  }, \"FreqCount\"), \", \", mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://simple-circuit.com/arduino-frequency-counter-project/\"\n  }, \"also see\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://www.soundonsound.com/techniques/introducing-polyphony\"\n  }, \"https://www.soundonsound.com/techniques/introducing-polyphony\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Add MIDI a input jack to be able to play the synth without a computer\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"add MCP4728 to \", mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"../diy-midi-keyboard\"\n  }, \"keyboard scanner\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"build a eurorack module\")), mdx(\"h2\", {\n    \"id\": \"similar-devices\"\n  }, \"Similar Devices\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://mutable-instruments.net/modules/yarns/\"\n  }, \"https://mutable-instruments.net/modules/yarns/\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://bastl-instruments.com/eurorack/modules/1983\"\n  }, \"https://bastl-instruments.com/eurorack/modules/1983\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://github.com/joeSeggiola/arduino-eurorack-projects/tree/master/midi4plus1\"\n  }, \"https://github.com/joeSeggiola/arduino-eurorack-projects/tree/master/midi4plus1\"))));\n}\n;\nMDXContent.isMDXComponent = true;","slug":"/polyphonic-cv/","title":"Polyphonic MIDI to CV","tags":[],"keywords":["synthesis","electronics"],"date":"May 22, 2021","image":null,"imageAlt":null,"socialImage":null},"previous":{"__typename":"MdxBlogPost","id":"9aca094e-1832-569f-bf94-257817489215","excerpt":"Lately, I've been learning about analog synthesis.\nIn this post, I want to document what I've learned so far and how I approached the topic…","slug":"/analog-synthesis/","title":"A Macro View on Analog Synthesis","date":"May 14, 2021"},"next":null},"pageContext":{"id":"d61bf6ee-8b0c-5e6c-85b8-8a001ca9d0dc","previousId":"9aca094e-1832-569f-bf94-257817489215"}},"staticQueryHashes":["386998304","4198970465","764694655"]}